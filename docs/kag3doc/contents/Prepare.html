<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from Prepare.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>准备工作</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里関連リファレンス用標準スタイル" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="主页" />
</head>
<body>
<h1><a id="id129" name="id129">准备工作</a>
</h1><div class="para"><div>
　首先，在吉里吉里 SDK 的文件夹（有 <code class="inlinecode">krkr.eXe</code> 的地方）下，创建一个以项目名命名的文件夹。项目名可以是任何名称。但是，请避免使用"<code class="inlinecode">data</code>"这个文件夹名（<code class="inlinecode">data</code> 这个文件夹名在必要时发布的时候会使用）。这个文件夹称为<a id="id130" name="id130" class="targanchor"><dfn>项目文件夹</dfn></a>。<br />
<br />
　然后，将 KAG 系统复制到该文件夹下。解压下载的 KAG LZH 文件后应该有一个名为 <code class="inlinecode">template</code> 的文件夹。将其<em>内容</em>（不是 <code class="inlinecode">template</code> 文件夹本身）复制到这个项目文件夹中。<br />
<br />
　配置如下所示。<br />
<br /><div class="descimg"><img width="314" height="275" alt="Folders.png" src="Folders.png" /><br />文件复制完成</div><br />　然后，<code class="inlinecode">system</code> 文件夹中有一个名为 <code class="inlinecode">Config.~new</code> 的文件，请将其重命名为 <code class="inlinecode"><a id="id131" name="id131" class="targanchor"><dfn>Config.tjs</dfn></a></code>。然后，用文本编辑器打开 <code class="inlinecode">Config.tjs</code>。<br />
<br />
<br />
　<code class="inlinecode">Config.tjs</code> 还有其他各种需要设置的地方，以后应该会需要修改。详细说明写在 <code class="inlinecode">Config.tjs</code> 内，请参考那里。<br />
<br />
<br />
　另外，在复制的文件夹中可能有"～该文件可以删除～"这样的文件，这是为了防止某些归档解压软件不解压空文件夹而放置的虚拟文件。可以删除（即使保留也没有特别的问题）。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　更新 KAG 时，基本上只需要将新 KAG 的 <code class="inlinecode">system</code> 文件夹内容覆盖到现有的 <code class="inlinecode">system</code> 文件夹即可。更新后的首次运行时会自动进行旧 <code class="inlinecode">Config.tjs</code> 的继承，请按照屏幕指示操作。<br />
</div><br />
</div></div>
<h1><a id="id132" name="id132">文件夹说明</a>
</h1><div class="para"><div>
　复制后，会一起复制几个文件夹。下面说明各个文件夹。<br />
　其实不一定要按照这些文件夹的规定，但如果要更改文件夹配置，可能需要修改 <code class="inlinecode"><a id="id133" name="id133" class="targanchor"><dfn>Initialise.tjs</dfn></a></code> 的内容。详细信息请查看 <code class="inlinecode">Initialise.tjs</code> 的内容（.tjs 文件是文本文件，用文本编辑器打开）。<br />
　另外，无论在这些文件夹中放入什么内容，在 KAG 的文件指定中都不需要指定文件夹名。即使在 <code class="inlinecode">bgimage</code> 文件夹中放入 MIDI 文件也没关系。只是为了方便，预先创建了文件夹<code class="inlinecode">(^^)</code><br />
<br />
　这些文件夹即使保持为空也没有问题。不需要的文件夹也可以删除。<br />
<br />
<dl>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id134" name="id134" class="targanchor"><dfn>system 文件夹</dfn></a></dt>
<dd>　<code class="inlinecode">system</code> 文件夹包含 KAG 运行所需的系统文件。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id135" name="id135" class="targanchor"><dfn>scenario 文件夹</dfn></a></dt>
<dd>　<code class="inlinecode">scenario</code> 文件夹用于放置情节文件。情节文件是扩展名为 .ks 的文件，其中使用标签嵌入了指定在 KAG 中显示哪些文本、显示哪些图像等指示。<br />
　顺便说一下，启动吉里吉里时指定的是"项目文件夹"，而不是单个情节文件。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id136" name="id136" class="targanchor"><dfn>bgimage 文件夹</dfn></a></dt>
<dd>　用于放置要显示的背景图像的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id137" name="id137" class="targanchor"><dfn>fgimage 文件夹</dfn></a></dt>
<dd>　用于放置要显示的前景图像（如角色立绘等）的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id138" name="id138" class="targanchor"><dfn>image 文件夹</dfn></a></dt>
<dd>　用于放置其他图像（例如CG图）等的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id139" name="id139" class="targanchor"><dfn>bgm 文件夹</dfn></a></dt>
<dd>　用于放置 BGM（背景音乐）数据的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id140" name="id140" class="targanchor"><dfn>sound 文件夹</dfn></a></dt>
<dd>　用于放置音效数据的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id141" name="id141" class="targanchor"><dfn>rule 文件夹</dfn></a></dt>
<dd>　用于放置通用转场规则图像的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id142" name="id142" class="targanchor"><dfn>others 文件夹</dfn></a></dt>
<dd>　其他。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id143" name="id143" class="targanchor"><dfn>video 文件夹</dfn></a></dt>
<dd>　用于放置视频文件。</dd></dl></div></div>
<h1><a id="id144" name="id144">支持的图像格式</a>
</h1><div class="para"><div>
　KAG（更确切地说是吉里吉里）支持的图像格式如下。<br />
　也请参阅<a target="main" class="jump" href="GraphicFormats.html">关于图像格式</a>。<br />
<br />
<dl>
<dt><a id="id145" name="id145" class="targanchor"><dfn>BMP 图像</dfn></a></dt>
<dd>　扩展名是 .bmp 或 .dib。在吉里吉里中，只支持无压缩的 BMP。<br />
　32bit (32bpp) 的 BMP 被视为带有 Alpha 通道的位图。</dd>
<dt><a id="id146" name="id146" class="targanchor"><dfn>JPEG 图像</dfn></a></dt>
<dd>　扩展名是 .jpeg 或 .jpg。可以处理各种图形工具输出的 JPEG 图像。</dd>
<dt><a id="id147" name="id147" class="targanchor"><dfn>Portable Network Graphic 图像</dfn></a>（<a id="id148" name="id148" class="targanchor"><dfn>PNG 图像</dfn></a>）</dt>
<dd>　扩展名是 .png。可以用各种图形工具输出。也支持 Alpha 通道和透明色指定。</dd>
<dt><a id="id149" name="id149" class="targanchor"><dfn>Entis Rasterized Image format 图像</dfn></a>（<a id="id150" name="id150" class="targanchor"><dfn>ERI 图像</dfn></a>）</dt>
<dd>　扩展名是 .eri。这是由 Leshade Entis 氏开发、设计的无损图像压缩技术·格式。通称"恵理酱"。<br />
　图像转换器等实用程序可以从"恵理酱club" <a target="_top" class="jump" href="http://www.entis.jp/eri/">http://www.entis.gr.jp/eri/</a> 获取。<br />
<br />
　使用这种图像压缩格式时，版权方面需要<em>特别</em>注意。详细信息请参阅吉里吉里 SDK Help 的"使用条件等"以及上述"恵理酱 club"。</dd>
<dt><a id="id151" name="id151" class="targanchor"><dfn>TLG5 图像</dfn></a></dt>
<dd>　扩展名是 .tlg（不是 .tlg5）。这是吉里吉里独有的无损图像压缩格式，特点是可以高速展开。支持全色彩图像和带有 Alpha 通道的全色彩图像。</dd>
<dt><a id="id152" name="id152" class="targanchor"><dfn>TLG6 图像</dfn></a></dt>
<dd>　扩展名是 .tlg（不是 .tlg6）。这是吉里吉里独有的无损图像压缩格式，特点是高压缩率和相对高速的展开。支持全色彩图像和带有 Alpha 通道的全色彩图像。</dd>
<dt>其他图像</dt>
<dd>　使用 <a id="id153" name="id153" class="targanchor"><dfn>Susie 插件</dfn></a> 可以支持这些以外的图像格式。请将 Susie 插件放在吉里吉里可执行文件 krkr.eXe 的同一文件夹、其下的 <code class="inlinecode">plugin</code> 文件夹或项目文件夹中。（另外，请参阅后面的"关于插件"）</dd></dl></div></div>
<h1><a id="id154" name="id154">支持的音频格式</a>
</h1><div class="para"><div>
<br />
　KAG（更确切地说是吉里吉里）支持的音频格式如下。<br />
　音效只能使用 PCM。<br />
　根据 BGM 使用的格式，可能需要修改 KAG 的 Config.tjs。详细信息请查看 Config.tjs 的内容。<br />
<br />
<dl>
<dt><a id="id155" name="id155" class="targanchor"><dfn>PCM</dfn></a></dt>
<dd>　标准情况下，可以播放无压缩的 RIFF-WAVE（扩展名是 .wav）。<br />
<br />
　除了无压缩的 RIFF-WAVE 外，还可以播放 Ogg Vorbis（*.ogg）、TCWF（*.tcw）、Microsoft ADPCM（*.wav）等，但需要插件。<br />
　作为吉里吉里2分发文件，附带了 Ogg Vorbis 用（wuvorbis.dll）、TCWF 用（wutcwf.dll）、Microsoft ADPCM 用（wumsadp.dll）插件。<br />
<br />
　Ogg Vorbis 是免专利、免专利费的压缩音乐格式，可以与 MP3 相同的方式使用。编码器可以从 <a target="_top" class="jump" href="http://www.vorbis.com/">http://www.vorbis.com/</a> 获取。<br />
<br />
　也可以使用其他插件（如果有的话）来增加可播放的格式。关于插件，除了各插件的说明书外，请参阅后面的"关于插件"。<br />
<br />
　无压缩 Wave、Ogg Vorbis、TCWF、Microsoft ADPCM 各格式，可以使用 Loop Tuner（可从支持页面获取）创建循环信息，从而可以精细指定循环位置。这样可以实现感觉不到循环连接处的循环播放。</dd>
<dt><a id="id156" name="id156" class="targanchor"><dfn>MIDI 序列数据</dfn></a></dt>
<dd>　可以播放 Standard MIDI Format（扩展名是 .smf 或 .mid）。如果要进行交叉淡入淡出，需要一些注意事项，详细信息请参阅吉里吉里 SDK Help 的"关于 MIDI 声音缓冲区"。</dd>
<dt><a id="id157" name="id157" class="targanchor"><dfn>CD-DA</dfn></a></dt>
<dd>　可以播放 <a id="id158" name="id158" class="targanchor"><dfn>CD-XA</dfn></a> 的 CD-DA 部分。CD-XA 是作为 CD-ROM 的计算机数据和作为 CD-DA 的音频数据共存的 CD 格式。吉里吉里基于 CD-ROM 的计算机数据的卷标进行可用 CD-ROM 驱动器的搜索，所以只能处理 CD-XA 格式的 CD。（不过如果像本教程中那样明确指定驱动器名的话是可以播放的...）</dd></dl></div></div>
<h1><a id="id159" name="id159">支持的视频格式</a>
</h1><div class="para"><div>
<dl>
<dt><a id="id160" name="id160" class="targanchor"><dfn>MPEG I</dfn></a></dt>
<dd>　支持一般的 MPEG I。<br />
　但是，发布时需要将 <a id="id161" name="id161" class="targanchor"><dfn>krmovie.dll</dfn></a> 放在与吉里吉里可执行文件相同的位置。另外，视频播放需要播放环境中安装 DirectX 8。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　未进行音频多路复用的纯视频 MPEG I 流的扩展名请使用 .mpv 而不是 .mpeg/.mpg。吉里吉里根据扩展名判断视频格式。<br />
</div><br />
</dd>
<dt><a id="id162" name="id162" class="targanchor"><dfn>WMV</dfn></a></dt>
<dd>　支持 WMV。<br />
　可播放的 WMV 版本取决于系统中安装的 Media Player 或 DirectX，但推荐安装 DirectX 9 以后的环境。</dd></dl><br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　即使视频存储在 Releaser 创建的档案或可执行文件中，吉里吉里也可以直接从档案中播放视频（无需通过临时文件）。但是，在 Releaser 中需要将视频文件分类为"不压缩"（默认分类会自动设为不压缩）。<br />
</div><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　不支持 AVI 格式的视频。</div><br />
</div></div>
<h1><a id="id163" name="id163">Flash</a>
</h1><div class="para"><div>
<dl>
<dt><a id="id164" name="id164" class="targanchor"><dfn>SWF</dfn></a></dt>
<dd>　支持 Macromedia Flash 的播放。<br />
　但是，发布时需要将 <a id="id165" name="id165" class="targanchor"><dfn>krflash.dll</dfn></a> 放在与吉里吉里可执行文件相同的位置。另外，SWF 的播放需要安装 Flash Player。<br />
　Flash 的播放方法与视频的处理方式相同。</dd></dl><br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　对 Flash 的支持并不完善。需要键盘输入的 Flash 内容可能无法正常工作。另外，如果 SWF 文件存储在 XP3 等档案中，会先写出到临时文件再使用，因此建议不要将大型 SWF 文件（超过 3～5MB 的文件）存储在档案中。<br />
</div><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　作者没有 Flash 制作环境所以没有测试，但可以通过 Flash 内容的控制跳转到 KAG 情节的任意标签。在 Action Get URL（URL 显示动作）中，将 URL 指定为 <code class="inlinecode"><em>FSCommand:Go</em></code>，将显示目标窗口指定为"情节文件/标签"的格式（例：<code class="inlinecode"><em>first.ks/label2</em></code>）<br />
　使用 <code class="inlinecode"><em>FSCommand:Eval</em></code>，将显示目标窗口指定为 TJS 表达式，可以在动作发生时执行任意的 TJS 表达式（如给变量赋值等）。<br />
　在 openvideo 标签或 playvideo 标签中，可以在 storage 属性的文件名后写 ?，然后指定传递给 Flash 的参数（例：<code class="inlinecode">hoge.swf?name=value&amp;param=content</code>）。<br />
</div><br />
</div></div>


<h1><a id="id166" name="id166">支持的档案格式</a>
</h1><div class="para"><div>
<dl>
<dt><a id="id167" name="id167" class="targanchor"><dfn>XP3</dfn></a> 和 <a id="id168" name="id168" class="targanchor"><dfn>PEXP3</dfn></a></dt>
<dd>　可以处理吉里吉里独有的档案格式 XP3。<br />
　PEXP3 是"吉里吉里可执行文件"与 XP3 格式结合的格式，可以将作品打包到单个可执行文件中。<br />
　这两种格式都可以用吉里吉里 SDK 附带的 Releaser 创建。</dd>
<dt>其他档案格式</dt>
<dd>　使用 <a id="id169" name="id169" class="targanchor"><dfn>Susie 插件</dfn></a> 可以支持这些以外的档案格式。（请参阅后面的"关于插件"）</dd></dl></div></div>


<h1><a id="id170" name="id170">预渲染字体</a>
</h1><div class="para"><div>
　预渲染字体是制作者创建的字体数据。通过使用它，可以始终以制作者预期的字体显示，不受 OS 或环境影响。也可以自由使用外字。<br />
　预渲染字体用 <a id="id171" name="id171" class="targanchor"><dfn>krkrfont.exe</dfn></a> 创建。创建时，用于竖写的字体请使用带有 @ 前缀的字体。<br />
<br />
　预渲染字体文件具有 .tft 扩展名。使用时请放在 others 文件夹等位置，用 mappfont 标签分配给任意字体。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　预渲染字体创建工具的使用方法请参阅吉里吉里 SDK 帮助。<br />
</div><br />
</div></div>
<h1><a id="id172" name="id172">关于插件</a>
</h1><div class="para"><div>
　Susie 插件、扩展 PCM 可播放格式的插件，或其他插件，如果不用 <a id="id173" name="id173" class="targanchor"><dfn>loadplugin</dfn></a> 标签指定就无法使用。<br />
<br />
　例如，如果要使用 wuvorbis.dll，需要写成：<br />
<br />

<br />
<code class="bq">@loadplugin&nbsp;module=wuvorbis.dll<br />
</code>
<br />

<br />
<br />
　另外，插件需要放在以下任一位置：<ul><li>与吉里吉里可执行文件（krkr.eXe）相同的位置</li><li>可执行文件所在文件夹下的 <a id="id174" name="id174" class="targanchor"><dfn>plugin 文件夹</dfn></a></li><li>项目文件夹</li></ul>　如果放在项目文件夹中，会被 Releaser 包含在档案或可执行文件中，但<em>不推荐</em>这样做。最好不要包含在档案中，而是与主体放在同一文件夹中分发（如果包含在档案中，从 CD-ROM 直接执行时等情况下会出错）。<br />
<br />
　krmovie.dll 和 krflash.dll 不是插件，所以不需要用 loadplugin 标签指定。<br />
<br />
　也请参阅吉里吉里 SDK 帮助的"关于插件"。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　吉里吉里1 的情况下，只需放在与可执行文件相同位置就可以使用，但吉里吉里2 的情况下需要明确指定插件。<br />
</div><br />
</div></div>
<h1><a id="id175" name="id175">UNICODE 支持</a>
</h1><div class="para"><div>
　为了编辑情节文件和 TJS 脚本，需要文本编辑器。<br />
　通常使用平时用的文本编辑器就没有问题，但由于吉里吉里输出的控制台日志文件和 KAG 的存档数据是以 UNICODE 输出的，如果要编辑 UNICODE 文本，需要支持 UNICODE 的文本编辑器。<br />
　另外，如果要在情节文件或 TJS 脚本中写入日语文字以外的文字（这里的日语文字指日语版 Windows 中通常可用的文字），需要用 UNICODE 文本来编写。<br />
<br />
　要显示日语文字以外的语言需要满足几个条件。<br />
<br />
<ul><li>相应的情节文件或 TJS 脚本文件用 UNICODE 编写（UNICODE 编写的文本文件和非 UNICODE 的文本文件可以混合使用）</li><li>如果不使用预渲染字体文件，游戏运行环境的 OS 必须是 Windows NT 系（Windows 2000 或 Windows XP、Vista 以后）（如果使用预渲染字体文件，则与运行环境的 OS 无关）</li><li>指定包含要显示语言文字的字体</li><li>要显示的语言是从左到右（横写）或从上到下（竖写）的语言</li></ul><br />
　在任何情况下，能够显示日语以外文字的也只是游戏画面内，在窗口标题栏或菜单项等使用 Windows 标准用户界面的部分只能显示日语文字。另外，用 edit 标签生成的编辑器只能输入日语文字。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　上面写的是日语文字，但基本上吉里吉里遵循运行 OS 的语言区域设置（日语版 Windows 就是日语文字，中文版 Windows 就是中文等）。不过作者没有验证过。<br />
</div><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　当前的吉里吉里/KAG 只在 Windows 上运行，所以 UNICODE 暂时指的是小端序的 UTF-16（但不能使用代理对）。<br />
　另外，吉里吉里要求 UNICODE 文本必须是小端序的 UTF-16，而且开头必须有 BOM（字节顺序标记），否则无法正常识别字符编码（目前即使有正式的 BOM，也无法读取大端序的 UTF-16）。<br />
</div><br />
</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
